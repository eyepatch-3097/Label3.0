{% extends "base.html" %} {% block title %}Label History – {{ workspace.name
}}{% endblock %} {% block content %}
<div class="row justify-content-center">
  <div class="col-lg-10">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h1 class="h4 mb-0">Label History</h1>
      <a
        href="{% url 'label_generate_start' workspace.id %}"
        class="btn btn-primary btn-sm"
        >Generate New Labels</a
      >
    </div>

    {% if batches %}
    <div class="card shadow-sm">
      <div class="card-body p-3">
        <div class="table-responsive">
          <table class="table table-sm align-middle mb-0">
            <thead>
              <tr>
                <th>Created</th>
                <th>Template</th>
                <th>EAN / GS1</th>
                <th>Qty</th>
                <th>By</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              {% for b in batches %}
              <tr>
                <td>{{ b.created_at|date:"Y-m-d H:i" }}</td>
                <td>{{ b.template.name }}</td>
                <td>
                  {{ b.ean_code }} {% if b.gs1_code %}<br /><span
                    class="text-muted small"
                    >GS1: {{ b.gs1_code }}</span
                  >{% endif %}
                </td>
                <td>{{ b.quantity }}</td>
                <td>
                  {% if b.created_by %} {{ b.created_by.email }} {% else %}
                  <span class="text-muted small">—</span>
                  {% endif %}
                </td>
                <td class="text-end">
                  <a
                    href="{% url 'label_generate_single_preview' workspace.id b.id %}"
                    class="btn btn-outline-secondary btn-sm"
                  >
                    View
                  </a>
                  <a
                    href="{% url 'label_batch_print' workspace.id b.id %}"
                    class="btn btn-primary btn-sm ms-1"
                  >
                    Print Batch
                  </a>
                  <a
                    href="{% url 'label_batch_export_csv' workspace.id b.id %}"
                    class="btn btn-outline-success btn-sm ms-1"
                  >
                    Export CSV
                  </a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
    {% else %}
    <p class="text-muted">No label batches generated yet.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
